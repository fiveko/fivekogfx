/*
 Created by FIVEKO.com 2017

 The source code is designed and developed for educational purposes only. 
 It is designed for no other purpose and neither the authors nor their institutions 
 accept any liability concerning its use.

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,h,g){b instanceof String&&(b=String(b));for(var e=b.length,d=0;d<e;d++){var a=b[d];if(h.call(g,a,d,b))return{i:d,v:a}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,g){b!=Array.prototype&&b!=Object.prototype&&(b[h]=g.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,h,g,e){if(h){g=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var d=b[e];d in g||(g[d]={});g=g[d]}b=b[b.length-1];e=g[b];h=h(e);h!=e&&null!=h&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var h=0;return $jscomp.iteratorPrototype(function(){return h<b.length?{done:!1,value:b[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var h=b[Symbol.iterator];return h?h.call(b):$jscomp.arrayIterator(b)};$jscomp.owns=function(b,h){return Object.prototype.hasOwnProperty.call(b,h)};
$jscomp.polyfill("WeakMap",function(b){function h(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function g(a){var c=Object[a];c&&(Object[a]=function(a){h(a);return c(a)})}if(function(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),f=new b([[a,2],[c,3]]);if(2!=f.get(a)||3!=f.get(c))return!1;f["delete"](a);f.set(c,4);return!f.has(a)&&4==f.get(c)}catch(l){return!1}}())return b;var e="$jscomp_hidden_"+Math.random().toString().substring(2);g("freeze");g("preventExtensions");
g("seal");var d=0,a=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};a.prototype.set=function(a,c){h(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=c;return this};a.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};a.prototype.has=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};a.prototype["delete"]=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return a},"es6-impl","es3");$jscomp.MapEntry=function(){};$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(b){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),f=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=f.get(a)||1!=f.size||f.get({x:4})||f.set({x:4},"t")!=f||2!=f.size)return!1;var l=f.entries(),k=l.next();if(k.done||k.value[0]!=a||"s"!=k.value[1])return!1;k=l.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!l.next().done?!1:!0}catch(m){return!1}}())return b;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var h=new WeakMap,g=function(c){this.data_={};this.head_=a();this.size=0;if(c){c=$jscomp.makeIterator(c);for(var f;!(f=c.next()).done;)f=f.value,this.set(f[0],f[1])}};g.prototype.set=function(a,f){var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=f:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:f},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};g.prototype["delete"]=
function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};g.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=a();this.size=0};g.prototype.has=function(a){return!!e(this,a).entry};g.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};g.prototype.entries=function(){return d(this,function(a){return[a.key,
a.value]})};g.prototype.keys=function(){return d(this,function(a){return a.key})};g.prototype.values=function(){return d(this,function(a){return a.value})};g.prototype.forEach=function(a,f){for(var c=this.entries(),b;!(b=c.next()).done;)b=b.value,a.call(f,b[1],b[0],this)};g.prototype[Symbol.iterator]=g.prototype.entries;var e=function(a,f){var c=f&&typeof f;"object"==c||"function"==c?h.has(f)?c=h.get(f):(c=""+ ++k,h.set(f,c)):c="p_"+f;var b=a.data_[c];if(b&&$jscomp.owns(a.data_,c))for(var d=0;d<b.length;d++){var e=
b[d];if(f!==f&&e.key!==e.key||f===e.key)return{id:c,list:b,index:d,entry:e}}return{id:c,list:b,index:-1,entry:void 0}},d=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},a=function(){var a={};return a.previous=a.next=a.head=a},k=0;return g},"es6-impl","es3");
(function(){function b(a,b,c,f){this.controls=[];this.name=a;this.init=function(){this.controls=[];b.call(this);this.update.call(this)};this.update=function(){var a=new Date;f.call(this);for(var b=[],k=0;k<this.controls.length;k++){var d=this.controls[k].value;b.push("string"===typeof d?parseFloat(d):d)}c.apply(this,b);b=new Date;document.getElementById("log").innerText="Elapsed: "+(b-a)+" ms"};this.add=function(a){this.controls.push(a)};this.getValue=function(a){var c=this.controls.find(function(c){return c.id===
a});return"checkbox"!==c.type?c.vlaue:c.checked};this.reset=f}function h(a){var b=document.createElement("div");b.style.padding="1.2rem";b.innerHTML='<input type="file" style="display: none;"><button data-role="browse" style="margin: 10px; width: 100px;">Browse</button><button data-role="camera" style="margin: 10px; width: 100px;">Camera</button><button data-role="reset" style="margin: 10px; width: 100px;">Reset</button><select id="cmbFilters"></select>';b.querySelector("input[type=file]").addEventListener("change",
d.handleFiles);b.querySelector("button[data-role=browse]").addEventListener("click",function(){b.querySelector("input[type=file]").click()});b.querySelector("button[data-role=camera]").addEventListener("click",d.createVideo);b.querySelector("button[data-role=reset]").addEventListener("click",function(){window.redraw()});"true"===a.getAttribute("data-hide-selector")&&(b.querySelector("#cmbFilters").style.display="none");d.canvasElement.style.maxWidth="100%";a.insertBefore(b,a.firstChild)}function g(){console.log("test");
var a=document.querySelector("div[data-role=preview]");if(a){var b=a.getAttribute("data-callback"),c=a.getAttribute("data-filter"),f=a.getAttribute("data-source"),l=a.querySelector(".loader");l&&l.classList.remove("loader");a.insertBefore(d.canvasElement,a.firstChild);h(a);e.create(window[b]);d.loadImage(f,function(){e.select(c)})}}var e={filters:new Map,cmbFilters:null,Filter:b,create:function(a){var b=document.getElementById("cmbFilters");e.cmbFilters=b;e.cmbFilters.onchange=function(){document.getElementById("controls").innerHTML=
"";var a=e.filters.get(b.value);a&&a.init();return!1};var c=d.canvasElement;a.call(e,c,c);1===b.options.length&&(b.style.display="none")},select:function(a){cmbFilters.value=a;0>cmbFilters.selectedIndex&&(cmbFilters.value="Original");cmbFilters.onchange()},update:function(){var a=e.filters.get(cmbFilters.value);a&&a.update()},addFilter:function(a){var b=document.createElement("option"),c=a.name.split(" ").join("-"),f=a.name;e.filters.set(c,a);b.text=f;b.value=c;cmbFilters.add(b)},createSlider:function(a,
b,c,f,d,e,g,h){var k=document.createElement("div");k.innerHTML='<span class="input-group-prepend input-group-text" style="min-width:120px;">'+c+'</span><input type="range" class="form-control mx-2" id="'+b+'" ><span class="input-group-append input-group-text" style="min-width:60px;">'+f+"</span>";k.classList.add("input-group");k.style="max-width:420px; margin:auto;";var l=k.querySelector("#"+b);l.min=d;l.max=e;l.step=g;l.value=f;l.oninput=l.onchange=function(a){l.nextSibling.innerText=this.value};
l.onmouseup=l.ontouchend=h;a.appendChild(k);return l},createButton:function(a,b,c,f){var d=document.createElement("button");d.innerText=c;d.name=b;d.className="btn btn-primary m-3";d.onclick=f;a.appendChild(d);return d},createCheckbox:function(a,b,c,f,d){var e=document.createElement("div");e.innerHTML='<span class="input-group-prepend input-group-text" style="min-width:120px;">'+c+'</span><input type="checkbox" class="form-control mx-2" id="'+b+'" >';e.classList.add("input-group");e.style="max-width:420px; margin:auto;";
b=e.querySelector("#"+b);b.checked=f;b.onclick=d;a.appendChild(e);return b},createDropdown:function(a,b,c,f,d){var e=document.createElement("div"),g=document.createElement("select");g.innerText=b;g.name=b;g.className="form-control";f.forEach(function(a,b){var c=document.createElement("option");c.value=b+1;c.innerText=a;g.appendChild(c)});g.onchange=d;e.insertAdjacentHTML("beforeend",'<span class="input-group-prepend input-group-text" style="min-width:120px;">'+c+"</span>");e.classList.add("input-group");
e.style="max-width:420px; margin:auto;";e.appendChild(g);a.appendChild(e);return g},createSelector:function(a,b){var c={x:0,y:0,w:0,h:0},d={canvas:a,value:null};a.onmousedown=function(a){c.x=a.offsetX;c.y=a.offsetY};a.onmousemove=function(b){b.buttons&&(c.w=b.offsetX-c.x,c.h=b.offsetY-c.y,b=a.getContext("2d"),redraw(),b.beginPath(),b.rect(c.x,c.y,c.w,c.h),b.stroke())};a.onmouseup=function(a){b(c)};return d},redraw:function(){}},d={videoTimerId:null,videoElement:null,imageElement:new Image,canvasElement:document.createElement("canvas"),
resizeCanvas:function(a){var b=d.canvasElement,c=a.width||a.videoWidth;a=a.height||a.videoHeight;var f=(600<document.documentElement.clientWidth?600:document.documentElement.clientWidth-100)/Math.max(c,a);b.width=c*f;b.height=a*f},createVideo:function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(a){d.loadVideo(a,function(){console.log("Camera stream started!")})},
function(a){alert("Failed to initialize camera!")})},loadVideo:function(a,b){var c=d.canvasElement;d.videoElement||(d.videoElement=document.createElement("video"),d.videoElement.addEventListener("canplaythrough",d.startVideo,!0),d.videoElement.addEventListener("ended",d.videoDone,!0),c.onclick=function(){(d.videoElement.paused?d.startVideo:d.stopVideo)()});var f=d.videoElement;try{f.srcObject=a}catch(l){window.URL.revokeObjectURL(f.src),f.src=window.URL.createObjectURL(a)}window.redraw=function(){c.getContext("2d").drawImage(f,
0,0,c.width,c.height)}},startVideo:function(a){a=d.videoElement;a.play();a.muted=!0;clearInterval(d.videoTimerId);d.resizeCanvas(a);d.videoTimerId=setInterval(function(){e.update()},30)},stopVideo:function(){var a=d.videoElement;a&&(a.pause(),clearInterval(d.videoTimerId))},videoDone:function(){clearInterval(d.videoTimerId)},loadImage:function(a,b){var c=d.imageElement;c.onload=function(){var a=d.canvasElement;d.resizeCanvas(this);a.getContext("2d").drawImage(this,0,0,a.width,a.height);b()};window.redraw=
function(){var a=d.canvasElement;a.getContext("2d").drawImage(c,0,0,a.width,a.height)};a?"string"===typeof a?c.src=a:(window.URL.revokeObjectURL(c.src),c.src=window.URL.createObjectURL(a)):b()},loadMedia:function(a,b){},handleFiles:function(a){a=a.target.files[0];var b=a.type;("image"==b.substring(0,5)?d.loadImage:"video"==b.substring(0,5)?d.loadVideo:function(){})(a,function(){e.update()})}};window.addFilter=e.addFilter;window.Filter=b;window.createSlider=e.createSlider;window.createButton=e.createButton;
window.createCheckbox=e.createCheckbox;window.createDropdown=e.createDropdown;window.createSelector=e.createSelector;window.addEventListener("load",function(a){g()},!0)})(window);
